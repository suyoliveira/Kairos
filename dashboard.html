<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel - Kairós</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
</head>
<body class="dashboard-body">
    <!-- Dashboard Header -->
    <header class="dashboard-header">
        <div class="container">
            <div class="dashboard-header-content">
                <div class="dashboard-logo">
                    <a href="index.html">
                        <i class="fas fa-rocket rocket-icon"></i>
                        <span class="logo-text">Kairós<span class="logo-flow"></span>
                    </a>
                </div>
                
                <div class="dashboard-search">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Buscar tarefas, colaboradores..." id="searchInput">
                </div>
                
                <div class="dashboard-user">
                    <div class="notifications" id="notificationsBtn">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">3</span>
                    </div>
                    <div class="user-info" id="userMenu">
                        <div class="user-avatar">VS</div>
                        <div class="user-details">
                            <span class="user-name">Você</span>
                            <span class="user-role">Administrador</span>
                        </div>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Dashboard Content -->
    <div class="dashboard-container">
        <div class="dashboard-content">
            <!-- Sidebar -->
            <aside class="dashboard-sidebar">
                <div class="sidebar-section">
                    <h3>Menu Principal</h3>
                    <ul class="sidebar-menu">
                        <li><a href="dashboard.html" class="active">
                            <i class="fas fa-columns"></i> Dashboard
                        </a></li>
                        <li><a href="onboarding.html">
                            <i class="fas fa-user-plus"></i> Onboarding
                        </a></li>
                        <li><a href="#">
                            <i class="fas fa-tasks"></i> Minhas Tarefas
                        </a></li>
                        <li><a href="#">
                            <i class="fas fa-chart-bar"></i> Relatórios
                        </a></li>
                        <li><a href="#">
                            <i class="fas fa-cog"></i> Configurações
                        </a></li>
                    </ul>
                </div>
                
                <div class="sidebar-section">
                    <h3>Departamentos</h3>
                    <ul class="department-list">
                        <li>
                            <a href="#" class="department-filter active" data-department="todos">
                                Todos os Setores <span class="department-count">24</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" class="department-filter" data-department="rh">
                                Recursos Humanos <span class="department-count">5</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" class="department-filter" data-department="ti">
                                Tecnologia <span class="department-count">8</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" class="department-filter" data-department="vendas">
                                Vendas <span class="department-count">4</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" class="department-filter" data-department="marketing">
                                Marketing <span class="department-count">3</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" class="department-filter" data-department="financeiro">
                                Financeiro <span class="department-count">4</span>
                            </a>
                        </li>
                    </ul>
                </div>
                
                <div class="sidebar-section">
                    <h3>Filtros Rápidos</h3>
                    <div class="quick-filters">
                        <button class="filter-btn active" data-filter="all">Todas</button>
                        <button class="filter-btn" data-filter="priority" data-value="high">
                            <i class="fas fa-exclamation-circle"></i> Alta
                        </button>
                        <button class="filter-btn" data-filter="priority" data-value="medium">
                            <i class="fas fa-exclamation-triangle"></i> Média
                        </button>
                        <button class="filter-btn" data-filter="status" data-value="pending">
                            <i class="far fa-clock"></i> Pendentes
                        </button>
                    </div>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="dashboard-main">
                <!-- Quick Stats -->
                <div class="quick-stats">
                    <div class="stat-card">
                        <div class="stat-icon" style="background-color: rgba(255, 59, 48, 0.1);">
                            <i class="fas fa-tasks" style="color: #FF3B30;"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-number">18</h3>
                            <p>Tarefas Ativas</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background-color: rgba(52, 199, 89, 0.1);">
                            <i class="fas fa-check-circle" style="color: #34C759;"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-number">42</h3>
                            <p>Concluídas</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background-color: rgba(255, 149, 0, 0.1);">
                            <i class="fas fa-user-clock" style="color: #FF9500;"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-number">3</h3>
                            <p>Em Onboarding</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background-color: rgba(0, 122, 255, 0.1);">
                            <i class="fas fa-chart-line" style="color: #007AFF;"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-number">85%</h3>
                            <p>Produtividade</p>
                        </div>
                    </div>
                </div>

                <!-- Kanban Board -->
                <div class="kanban-board-container">
                    <div class="kanban-header">
                        <div>
                            <h2>
                                <i class="fas fa-columns"></i> Quadro Kanban
                                <span class="department-indicator" id="currentDepartment">Todos os Departamentos</span>
                            </h2>
                            <p>Arraste e solte para mover tarefas entre colunas</p>
                        </div>
                        <div class="kanban-actions">
                            <button class="btn-action btn-secondary-action">
                                <i class="fas fa-filter"></i> Filtrar
                            </button>
                            <button class="btn-action btn-primary-action btn-new-task">
                                <i class="fas fa-plus"></i> Nova Tarefa
                            </button>
                        </div>
                    </div>

                    <!-- Kanban Columns -->
                    <div class="kanban-columns">
                        <!-- To Do Column -->
                        <div class="kanban-column column-todo">
                            <div class="column-header">
                                <h3>A Fazer</h3>
                                <span class="column-count">5</span>
                            </div>
                            <div class="tasks-container" id="todo-column">
                                <!-- Task Cards will be inserted here by JavaScript -->
                                <div class="task-card high-priority" data-id="1" draggable="true">
                                    <div class="task-header">
                                        <div class="task-tags">
                                            <span class="task-tag tag-priority-high">ALTA PRIORIDADE</span>
                                            <span class="task-tag tag-onboarding">ONBOARDING</span>
                                        </div>
                                        <div class="task-actions">
                                            <button class="task-action-btn edit-task" title="Editar">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="task-action-btn delete-task" title="Excluir">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <h4 class="task-title">Integrar novo desenvolvedor</h4>
                                    <p class="task-description">Configurar ambiente de desenvolvimento e acessos aos sistemas</p>
                                    <div class="task-footer">
                                        <div class="task-assignee">
                                            <div class="assignee-avatar">JS</div>
                                            <span class="assignee-name">João Silva</span>
                                        </div>
                                        <div class="task-deadline">
                                            <i class="far fa-calendar"></i>
                                            <span class="deadline-overdue">Hoje</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="task-card medium-priority" data-id="2" draggable="true">
                                    <div class="task-header">
                                        <div class="task-tags">
                                            <span class="task-tag tag-priority-medium">MÉDIA PRIORIDADE</span>
                                            <span class="task-tag tag-ti">TI</span>
                                        </div>
                                        <div class="task-actions">
                                            <button class="task-action-btn edit-task" title="Editar">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="task-action-btn delete-task" title="Excluir">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <h4 class="task-title">Atualizar documentação API</h4>
                                    <p class="task-description">Documentar novos endpoints e atualizar Swagger</p>
                                    <div class="task-footer">
                                        <div class="task-assignee">
                                            <div class="assignee-avatar">MP</div>
                                            <span class="assignee-name">Maria Pereira</span>
                                        </div>
                                        <div class="task-deadline">
                                            <i class="far fa-calendar"></i>
                                            <span>15/10</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- In Progress Column -->
                        <div class="kanban-column column-progress">
                            <div class="column-header">
                                <h3>Em Andamento</h3>
                                <span class="column-count">3</span>
                            </div>
                            <div class="tasks-container" id="progress-column">
                                <div class="task-card onboarding" data-id="3" draggable="true">
                                    <div class="task-header">
                                        <div class="task-tags">
                                            <span class="task-tag tag-priority-high">ALTA PRIORIDADE</span>
                                            <span class="task-tag tag-onboarding">ONBOARDING</span>
                                        </div>
                                        <div class="task-actions">
                                            <button class="task-action-btn edit-task" title="Editar">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="task-action-btn delete-task" title="Excluir">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <h4 class="task-title">Treinamento novo analista</h4>
                                    <p class="task-description">Treinar em processos internos e ferramentas da empresa</p>
                                    <div class="task-footer">
                                        <div class="task-assignee">
                                            <div class="assignee-avatar">CS</div>
                                            <span class="assignee-name">Carlos Santos</span>
                                        </div>
                                        <div class="task-deadline">
                                            <i class="far fa-calendar"></i>
                                            <span>12/10</span>
                                        </div>
                                    </div>
                                    <div class="task-checklist">
                                        <div class="checklist-summary">
                                            <div class="checklist-progress">
                                                <div class="checklist-fill" style="width: 60%"></div>
                                            </div>
                                            <span>3/5 concluído</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- In Review Column -->
                        <div class="kanban-column column-review">
                            <div class="column-header">
                                <h3>Em Revisão</h3>
                                <span class="column-count">2</span>
                            </div>
                            <div class="tasks-container" id="review-column">
                                <div class="task-card low-priority" data-id="4" draggable="true">
                                    <div class="task-header">
                                        <div class="task-tags">
                                            <span class="task-tag tag-priority-low">BAIXA PRIORIDADE</span>
                                            <span class="task-tag tag-rh">RH</span>
                                        </div>
                                        <div class="task-actions">
                                            <button class="task-action-btn edit-task" title="Editar">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="task-action-btn delete-task" title="Excluir">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <h4 class="task-title">Atualizar política de férias</h4>
                                    <p class="task-description">Revisar e atualizar documento de política de férias</p>
                                    <div class="task-footer">
                                        <div class="task-assignee">
                                            <div class="assignee-avatar">AR</div>
                                            <span class="assignee-name">Ana Rodrigues</span>
                                        </div>
                                        <div class="task-deadline">
                                            <i class="far fa-calendar"></i>
                                            <span>20/10</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Done Column -->
                        <div class="kanban-column column-done">
                            <div class="column-header">
                                <h3>Concluído</h3>
                                <span class="column-count">8</span>
                            </div>
                            <div class="tasks-container" id="done-column">
                                <div class="task-card" data-id="5" draggable="true">
                                    <div class="task-header">
                                        <div class="task-tags">
                                            <span class="task-tag tag-priority-medium">MÉDIA PRIORIDADE</span>
                                            <span class="task-tag tag-ti">TI</span>
                                        </div>
                                        <div class="task-actions">
                                            <button class="task-action-btn edit-task" title="Editar">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="task-action-btn delete-task" title="Excluir">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <h4 class="task-title">Configurar novo servidor</h4>
                                    <p class="task-description">Configurar ambiente de staging para novos projetos</p>
                                    <div class="task-footer">
                                        <div class="task-assignee">
                                            <div class="assignee-avatar">RF</div>
                                            <span class="assignee-name">Ricardo Ferreira</span>
                                        </div>
                                        <div class="task-deadline">
                                            <i class="far fa-calendar"></i>
                                            <span>05/10</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Task Modal -->
    <div class="task-modal-overlay" id="taskModal">
        <div class="task-modal">
            <div class="modal-header">
                <h3>Nova Tarefa</h3>
                <button class="close-modal" id="closeModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="taskForm">
                <div class="modal-body">
                    <div class="form-group">
                        <label for="taskTitle">Título da Tarefa *</label>
                        <input type="text" id="taskTitle" class="form-control" placeholder="Digite o título da tarefa" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="taskDescription">Descrição *</label>
                        <textarea id="taskDescription" class="form-control" placeholder="Descreva a tarefa em detalhes..." rows="4" required></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="taskPriority">Prioridade</label>
                            <select id="taskPriority" class="form-control">
                                <option value="high">Alta Prioridade</option>
                                <option value="medium" selected>Média Prioridade</option>
                                <option value="low">Baixa Prioridade</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="taskDepartment">Departamento</label>
                            <select id="taskDepartment" class="form-control">
                                <option value="rh">Recursos Humanos</option>
                                <option value="ti" selected>Tecnologia</option>
                                <option value="vendas">Vendas</option>
                                <option value="marketing">Marketing</option>
                                <option value="financeiro">Financeiro</option>
                                <option value="geral">Geral</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="taskAssignee">Responsável</label>
                            <select id="taskAssignee" class="form-control">
                                <option value="João Silva">João Silva</option>
                                <option value="Maria Pereira">Maria Pereira</option>
                                <option value="Carlos Santos">Carlos Santos</option>
                                <option value="Ana Rodrigues">Ana Rodrigues</option>
                                <option value="Ricardo Ferreira">Ricardo Ferreira</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="taskDeadline">Prazo</label>
                            <input type="date" id="taskDeadline" class="form-control">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="taskTags">Tags (separadas por vírgula)</label>
                        <input type="text" id="taskTags" class="form-control" placeholder="ex: onboarding, urgente, projeto-x">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-action btn-secondary-action" id="cancelBtn">
                        Cancelar
                    </button>
                    <button type="submit" class="btn-action btn-primary-action" id="saveTaskBtn">
                        <i class="fas fa-save"></i> Salvar Tarefa
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Importando JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script src="scripts/main.js"></script>
    <script src="scripts/kanban.js"></script>
    
    <!-- Inicialização do Kanban -->
    <script>
        // Garantir que o DOM está carregado
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Dashboard carregado!');
            
            // Inicializar AOS (Animate On Scroll)
            if (typeof AOS !== 'undefined') {
                AOS.init({
                    duration: 800,
                    once: true
                });
            }
            
            // Verificar se o Kanban foi carregado
            if (typeof KanbanBoard !== 'undefined') {
                console.log('KanbanBoard carregado, inicializando...');
                window.kanbanBoard = new KanbanBoard();
            } else {
                console.error('KanbanBoard não encontrado! Verifique o arquivo kanban.js');
                
                // Carregar fallback básico
                setupBasicKanban();
            }
            
            // Configurar filtros de departamento
            document.querySelectorAll('.department-filter').forEach(filter => {
                filter.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Atualizar filtro ativo
                    document.querySelectorAll('.department-filter').forEach(f => f.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Atualizar indicador
                    const departmentName = this.textContent.split('<')[0].trim();
                    document.getElementById('currentDepartment').textContent = departmentName;
                    
                    // Filtrar tarefas
                    const department = this.dataset.department;
                    filterTasksByDepartment(department);
                });
            });
            
            // Configurar botão de nova tarefa
            document.querySelector('.btn-new-task')?.addEventListener('click', function() {
                const modal = document.getElementById('taskModal');
                if (modal) {
                    modal.style.display = 'flex';
                    document.body.style.overflow = 'hidden';
                    
                    // Resetar formulário
                    const form = document.getElementById('taskForm');
                    if (form) {
                        form.reset();
                        form.dataset.mode = 'create';
                        form.dataset.taskId = '';
                    }
                }
            });
            
            // Configurar fechar modal
            document.getElementById('closeModal')?.addEventListener('click', function() {
                const modal = document.getElementById('taskModal');
                if (modal) {
                    modal.style.display = 'none';
                    document.body.style.overflow = '';
                }
            });
            
            document.getElementById('cancelBtn')?.addEventListener('click', function() {
                const modal = document.getElementById('taskModal');
                if (modal) {
                    modal.style.display = 'none';
                    document.body.style.overflow = '';
                }
            });
            
            // Configurar submit do formulário
            const taskForm = document.getElementById('taskForm');
            if (taskForm) {
                taskForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    if (window.kanbanBoard && typeof window.kanbanBoard.validateTaskForm === 'function') {
                        if (window.kanbanBoard.validateTaskForm(this)) {
                            if (this.dataset.mode === 'create') {
                                window.kanbanBoard.createNewTask(this);
                            } else {
                                window.kanbanBoard.updateTask(this);
                            }
                            
                            // Fechar modal
                            const modal = document.getElementById('taskModal');
                            if (modal) {
                                modal.style.display = 'none';
                                document.body.style.overflow = '';
                            }
                        }
                    } else {
                        // Fallback básico
                        createTaskFallback(this);
                    }
                });
            }
            
            // Configurar busca
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    const tasks = document.querySelectorAll('.task-card');
                    
                    tasks.forEach(task => {
                        const title = task.querySelector('.task-title')?.textContent.toLowerCase() || '';
                        const description = task.querySelector('.task-description')?.textContent.toLowerCase() || '';
                        const assignee = task.querySelector('.assignee-name')?.textContent.toLowerCase() || '';
                        
                        const isVisible = title.includes(searchTerm) || 
                                        description.includes(searchTerm) || 
                                        assignee.includes(searchTerm);
                        
                        task.style.display = isVisible ? 'block' : 'none';
                    });
                });
            }
        });
        
        // Função fallback básica para o Kanban
        function setupBasicKanban() {
            console.log('Usando Kanban básico...');
            
            // Configurar drag and drop básico
            const tasks = document.querySelectorAll('.task-card');
            const columns = document.querySelectorAll('.kanban-column .tasks-container');
            
            tasks.forEach(task => {
                task.setAttribute('draggable', 'true');
                
                task.addEventListener('dragstart', function(e) {
                    this.classList.add('dragging');
                    e.dataTransfer.setData('text/plain', this.dataset.id);
                });
                
                task.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                });
            });
            
            columns.forEach(column => {
                column.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.style.backgroundColor = 'rgba(255, 59, 48, 0.05)';
                });
                
                column.addEventListener('dragleave', function() {
                    this.style.backgroundColor = '';
                });
                
                column.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.style.backgroundColor = '';
                    
                    const taskId = e.dataTransfer.getData('text/plain');
                    const draggedTask = document.querySelector(`.task-card[data-id="${taskId}"]`);
                    
                    if (draggedTask && draggedTask.parentNode !== this) {
                        this.appendChild(draggedTask);
                        updateColumnCounts();
                        
                        // Mostrar notificação
                        showBasicNotification('Tarefa movida com sucesso!', 'success');
                    }
                });
            });
            
            // Atualizar contadores
            function updateColumnCounts() {
                document.querySelectorAll('.kanban-column').forEach(column => {
                    const count = column.querySelectorAll('.task-card').length;
                    const countElement = column.querySelector('.column-count');
                    if (countElement) {
                        countElement.textContent = count;
                    }
                });
            }
            
            // Configurar botões de ação
            document.addEventListener('click', function(e) {
                // Editar tarefa
                if (e.target.closest('.edit-task')) {
                    const taskCard = e.target.closest('.task-card');
                    openEditModal(taskCard);
                }
                
                // Excluir tarefa
                if (e.target.closest('.delete-task')) {
                    const taskCard = e.target.closest('.task-card');
                    if (confirm('Tem certeza que deseja excluir esta tarefa?')) {
                        taskCard.remove();
                        updateColumnCounts();
                        showBasicNotification('Tarefa excluída!', 'success');
                    }
                }
            });
            
            updateColumnCounts();
        }
        
        function filterTasksByDepartment(department) {
            const tasks = document.querySelectorAll('.task-card');
            
            tasks.forEach(task => {
                if (department === 'todos') {
                    task.style.display = 'block';
                } else {
                    const taskDepartment = task.querySelector('.task-tag:not(.tag-priority)')?.textContent.toLowerCase() || '';
                    const shouldShow = taskDepartment.includes(department);
                    task.style.display = shouldShow ? 'block' : 'none';
                }
            });
        }
        
        function createTaskFallback(form) {
            const formData = new FormData(form);
            
            // Criar ID único
            const taskId = 'task-' + Date.now();
            
            // Criar elemento da tarefa
            const taskElement = document.createElement('div');
            taskElement.className = 'task-card';
            taskElement.dataset.id = taskId;
            taskElement.setAttribute('draggable', 'true');
            
            const priority = formData.get('priority');
            const department = formData.get('department');
            const assignee = formData.get('assignee');
            const assigneeInitials = assignee.split(' ').map(n => n[0]).join('').toUpperCase();
            
            taskElement.innerHTML = `
                <div class="task-header">
                    <div class="task-tags">
                        <span class="task-tag tag-priority-${priority}">
                            ${priority === 'high' ? 'ALTA' : priority === 'medium' ? 'MÉDIA' : 'BAIXA'} PRIORIDADE
                        </span>
                        <span class="task-tag tag-${department}">
                            ${department.toUpperCase()}
                        </span>
                    </div>
                    <div class="task-actions">
                        <button class="task-action-btn edit-task" title="Editar">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="task-action-btn delete-task" title="Excluir">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <h4 class="task-title">${formData.get('title') || 'Nova Tarefa'}</h4>
                <p class="task-description">${formData.get('description') || 'Descrição da tarefa...'}</p>
                <div class="task-footer">
                    <div class="task-assignee">
                        <div class="assignee-avatar">${assigneeInitials}</div>
                        <span class="assignee-name">${assignee}</span>
                    </div>
                    <div class="task-deadline">
                        <i class="far fa-calendar"></i>
                        <span>${formData.get('deadline') || 'Sem data'}</span>
                    </div>
                </div>
            `;
            
            // Adicionar à coluna "A Fazer"
            const todoColumn = document.getElementById('todo-column');
            if (todoColumn) {
                todoColumn.appendChild(taskElement);
                
                // Atualizar contadores
                updateColumnCounts();
                
                // Mostrar notificação
                showBasicNotification('Tarefa criada com sucesso!', 'success');
                
                // Fechar modal
                const modal = document.getElementById('taskModal');
                if (modal) {
                    modal.style.display = 'none';
                    document.body.style.overflow = '';
                }
                
                // Configurar eventos da nova tarefa
                setupTaskEvents(taskElement);
            }
        }
        
        function openEditModal(taskCard) {
            const modal = document.getElementById('taskModal');
            const form = document.getElementById('taskForm');
            
            if (!modal || !form) return;
            
            // Preencher formulário com dados da tarefa
            const title = taskCard.querySelector('.task-title').textContent;
            const description = taskCard.querySelector('.task-description').textContent;
            
            form.querySelector('#taskTitle').value = title;
            form.querySelector('#taskDescription').value = description;
            
            // Configurar modo de edição
            form.dataset.mode = 'edit';
            form.dataset.taskId = taskCard.dataset.id;
            
            // Abrir modal
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }
        
        function setupTaskEvents(taskElement) {
            // Drag and drop
            taskElement.addEventListener('dragstart', function(e) {
                this.classList.add('dragging');
                e.dataTransfer.setData('text/plain', this.dataset.id);
            });
            
            taskElement.addEventListener('dragend', function() {
                this.classList.remove('dragging');
            });
            
            // Botões de ação
            taskElement.querySelector('.edit-task')?.addEventListener('click', function() {
                openEditModal(taskElement);
            });
            
            taskElement.querySelector('.delete-task')?.addEventListener('click', function() {
                if (confirm('Tem certeza que deseja excluir esta tarefa?')) {
                    taskElement.remove();
                    updateColumnCounts();
                    showBasicNotification('Tarefa excluída!', 'success');
                }
            });
        }
        
        function updateColumnCounts() {
            document.querySelectorAll('.kanban-column').forEach(column => {
                const tasksContainer = column.querySelector('.tasks-container');
                const count = tasksContainer?.querySelectorAll('.task-card').length || 0;
                const countElement = column.querySelector('.column-count');
                if (countElement) {
                    countElement.textContent = count;
                }
            });
        }
        
        function showBasicNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: ${type === 'success' ? '#34C759' : '#FF3B30'};
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
            
            // Adicionar animações
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
        }
    </script>
</body>
</html>
